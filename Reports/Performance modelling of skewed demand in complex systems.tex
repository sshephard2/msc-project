\documentclass[runningheads]{llncs}
\usepackage{graphicx,amssymb,pepa,pgfplots,pgfplotstable,amsmath,placeins,listings}
\usetikzlibrary{patterns}

% ---- Highlighting placeholder text
\usepackage{xcolor}
\usepackage{framed}
\colorlet{shadecolor}{red!20}

\begin{document}
\title{Performance modelling and simulation of skewed demand in complex systems}

\author{Stephen Shephard}

\institute{School of Computing Science, Newcastle University, Newcastle upon Tyne, NE1 7RU\\
	\email{s.shephard2@newcastle.ac.uk}}

\maketitle

%
% ---- Abstract and keywords
%
\begin{abstract}
On-line Transaction Processing (OLTP) applications must frequently deal with the issue of skewed demand for some resources.  This demand may overwhelm the whole system, affecting the owner's reputation and revenue.  This paper presents system architectures for a ticketing use case using a selection of distributed computing technologies of the Cloud.  It proposes models of these architectures and uses them to predict throughput in skewed demand scenarios.  The experimental results of the models are then tested against simple built systems.  It finds that the models correctly predict that a shared queue constrains throughput in proportion to relative demand, but overestimate the gains from a distributed database with replication.
	\keywords{Cloud, middleware, microservices, distributed databases, modelling, performance}
\end{abstract}

%
% ---- Introduction
%

\section{Introduction}\label{sec:introduction}

There are many high-profile examples of whole IT systems brought down by customer demand for part of their services.  Customers were prevented from using any part of the London 2012 Olympic ticketing website on launch day to avoid demand overloading the system \cite{RN1067}.  Demand for the finale of `True Detective' \cite{RN1066} brought down HBO Go.  Apple's iTunes Store suffered outage on the launch day of the iPhone 7 (new iPhone registration is carried out via an iTunes function) \cite{RN1068}.

This paper claims that it is possible to design and build more resilient systems through effective use of Cloud technologies where higher than normal demand for one function or type of resource would not block access to the others.  Skewed demand may be isolated so that it only affects parts of a system, or shared equally between different components. (The system may also adapt to demand by elastic scaling of resources, but this will not be considered as part of this paper).  When combining a middleware solution with a distributed database, however, where is the system bottleneck? If there are levels of demand that cannot be met on a limited budget, and that therefore some components will no longer meet the required throughput, what is the impact on the remainder of the system?

The paper is organised as follows.  Section \ref{sec:background} presents a use case based on ticket booking for a multi-sport event.  Section \ref{sec:technologies} selects a set of distributed technologies, and section \ref{sec:modelling} discusses modelling in PEPA.  Simple component models are proposed and tested in section \ref{sec:pepa-component-models} and composed into more complex system models that make end-to-end predictions.
The models will then be tested against actual systems in section \ref{sec:built-systems}, built using Java and the Java Spring framework \cite{RN1076}, Cassandra \cite{RN1050}\cite{RN1075} databases, and where appropriate Microsoft Azure Storage Queues \cite{RN1072}.  These systems will be instrumented with Coda Hale Metrics \cite{RN1079} and measured under different scenarios of skewed demand, using Apache JMeter test plans \cite{RN1074}.  Finally section \ref{sec:conclusions} evaluates the approach and makes suggestions for future work.

\subsection{Aims and Objectives}

The aim is to demonstrate that PEPA (Performance Evaluation Process Algebra) \cite{RN1051} may be used to construct models that are good predictors of the behaviour of real systems under skewed demand scenarios, and provide insights into the effectiveness of Cloud technologies for handling skewed demand.

The objectives are to:
\begin{itemize}
	\item show that distributed databases and middleware queues may be modelled in PEPA.
	\item show that these PEPA component models may be used to test skewed demand.
	\item show that the component models may be composed into system models with interesting behaviour under test.
	\item build actual system architectures for the PEPA models and show that the built systems behaviours match those predicted by the models.
\end{itemize}

%
% ---- Background
%

\section{Background}\label{sec:background}

Consider a general OLTP application using a distributed architecture, as shown in Figure \ref{figure:oltpapplication}.  Users access the application with a web-based front end.  Resources are stored in one or more databases.  In between the web servers and database are worker applications that service user requests, connected to the web servers by some middleware.  There are strategies for coping with skewed demand at each layer of this architecture.

\begin{figure}
	\label{figure:oltpapplication}
	\centering
	\includegraphics[trim = 5 5 5 5, clip, width=\textwidth]{img/application}
	\caption{OLTP application distributed architecture}
\end{figure}

\paragraph{Adapting.} A system using {\itshape elastic scaling} may adapt to increased demand. Rapid elasticity is an essential characteristic of Cloud Computing by the NIST definition \cite{RN56}.  Computing resources, for example web servers or worker applications, can be elastically and often automatically scaled to meet current demand.  This gives the appearance of resources that are limited only by the system owner's budget.

\paragraph{Sharing.} High demand may be shared between resources.  HTTP load balancing improves the scalability of a web-based application by distributing the demand across multiple web servers \cite{RN73}.  Shared middleware such as a point-to-point queue, provides a competing consumer pattern to balance load from several producers, e.g. web servers, between multiple consumers e.g. worker applications.

\paragraph{Isolating.} If it is not possible to satisfy the skewed demand within a given budget, then it may be appropriate to isolate that demand from the rest of the system.  Horizontal partitioning of a distributed database can place high demand resources on different data nodes.  Microservices architecture offers a pattern for partitioning the data resources, the worker applications and the web servers, connecting them into entirely separate smaller end-to-end services.

\subsection{Use Case}

The concrete use case for constructing models and building systems is a ticketing application.  Following the Olympic example given in the Introduction, tickets will be for a multi-sport event.  Some sports are more popular than others and it will be assumed that there will be predictable skewed demand for {\itshape athletics} tickets.  Use cases where the resources with skewed demand are unknown - where they are only discovered once the application goes online, requiring some adaptive approach - are out of scope.

The application has three possible operations:
\begin{enumerate}
\item Search (for available tickets)
\item Book (allocate a ticket to a customer)
\item Return (customer releases a ticket allocation)
\end{enumerate}

Such a ticketing application may be generalised to any system for allocating and releasing other resources with variable demand.

This paper considers the problem of higher than average demand for a particular type of ticket, and to what extent the system will allow users to search for other ticket types if some component is overloaded by the skewed demand for the most popular tickets.  It does not consider issues of fair allocation of scarce resources.

%
% ---- Technologies sub-document
%

\include{technologies}

%
% ---- Modelling sub-document
%

\include{modelling}

%
% ---- Model components sub-document
%

\include{models-components}

%
% ---- Model system sub-document
%

\include{models-system}

%
% ---- Built systems sub-document
%

\include{built-systems}

%
% ---- Conclusion sub-document
%

\include{conclusion}

%
% ---- Bibliography ----
%

\bibliographystyle{splncs03}
\bibliography{references}

\end{document}